
<div class="row">
	<div class="col-12">
		<div class="card">

			<div class="card-header">
				<div class="card-title">
					<h4>Delivery method</h4>
				</div>
			</div>
			<div class="card-body">
				<ul class="nav nav-pills nav-fill">
					<li class="nav-item" (click)="onSetDelivery('branch')">
						<span class="nav-link" [ngClass]="{'active': deliveryMethod === 'branch'}">At branch</span>
					</li>
					<li class="nav-item" (click)="onSetDelivery('bring')">
						<span class="nav-link" [ngClass]="{'active': deliveryMethod === 'bring'}">By mail</span>
					</li>
				</ul>
			</div>

			<div class="card-body" *ngIf="deliveryMethod === 'branch'">
				<div class="row">
                    <div class="col-12">
                        <h4>Get items at branch</h4>
						<p>Retrieve the items yourself at <b>{{branch.name}}</b></p>
                    </div>
                </div>
			</div>

			<div class="card-body" *ngIf="deliveryMethod === 'bring'">
				<div class="row">
                    <div class="col-12">
                        <h4>Delivery by mail</h4>
                        <p>Get the items sent to you with Bring from one of our storage facilities</p>
                    </div>
                </div>
				<div class="row mt-2" *ngIf="failureText">
					<div class="col-12">
						<div class="alert alert-warning">
							<fa-icon [icon]="'exclamation-triangle'" class="mr-2"></fa-icon>
							{{failureText}}
						</div>
					</div>
				</div>
				<div class="row mt-5" *ngIf="deliveryMethod === 'bring'">
                    <div class="col-12">
                        <h5>Shipment address</h5>
                    </div>
                    <div class="col-12">
                        <div class="input-group mb-3 input-group-lg">
                            <div class="input-group-prepend">
                                <span class="input-group-text">
                                    <fa-icon [icon]="'user'"></fa-icon>
                                </span>
                            </div>

                            <input
                                type="text"
                                class="form-control"
                                placeholder="Full Name"
								(change)="validateDeliveryMethodBring()"
								(keydown.enter)="onSetDelivery('bring')"
                                [(ngModel)]="toName">
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="input-group mb-3 input-group-lg">
                            <div class="input-group-prepend">
                                <span class="input-group-text">
									<fa-icon [icon]="'address-card'"></fa-icon>
                                </span>
                            </div>

                            <input
                                type="text"
                                class="form-control"
                                placeholder="Address"
								(change)="validateDeliveryMethodBring()"
								(keydown.enter)="onSetDelivery('bring')"
                                [(ngModel)]="toAddress">
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="input-group mb-3 input-group-lg">
                            <div class="input-group-prepend">
                                <span class="input-group-text">
                                    <fa-icon [icon]="'address-card'"></fa-icon>
                                </span>
                            </div>

                            <input
                                type="text"
                                maxlength="4"
                                class="form-control"
								(change)="onPostalCodeChange()"
								(keydown.enter)="onSetDelivery('bring')"
                                placeholder="Postal code"
                                [(ngModel)]="toPostalCode">

                            <input
                                type="text"
                                class="form-control"
                                placeholder="city"
								(keydown.enter)="onSetDelivery('bring')"
								[(ngModel)]="toPostalCity">
                        </div>
                    </div>
					<div class="col-12 mt-2">
						<button class="btn btn-outline-success btn-block" (click)="onSetDelivery('bring')">
							Confirm shipping address
						</button>
					</div>
                </div>
			</div>
            <div class="card-footer" *ngIf="deliveryMethod === 'bring' && currentDelivery && currentDelivery.amount !== 0 && !failureText">
				<div class="row justify-content-between">
					<div class="col-auto text-secondary">
						Estimated delivery date
					</div>
					<div class="col-auto">
						<div class="row justify-content-end">
							<div class="col-auto">
								{{currentDelivery.info['estimatedDelivery'] | blcDate:'until'}}
							</div>
						</div>
						<div class="row justify-content-end">
							<div class="col-auto text-secondary">
								<small>{{currentDelivery.info['estimatedDelivery'] | blcDate}}</small>
							</div>
						</div>
					</div>
				</div>
                <div class="row justify-content-between mt-2">
					<div class="col-auto text-secondary">
						Delivery cost
					</div>
					<div class="col-auto font-weight-bold">
						{{currentDelivery.amount | blcPrice}}
					</div>
				</div>
            </div>
		</div>
	</div>
</div>
